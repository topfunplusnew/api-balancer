---
alwaysApply: true
---


# Next.js + Expressï¼ˆJavaScriptï¼‰ä»£ç ç¼–å†™è§„èŒƒ

## ä¸€ã€æ ¸å¿ƒåŸåˆ™ï¼ˆJS é¡¹ç›®å°¤å…¶é‡è¦ï¼‰

### 1ï¸âƒ£ ç»“æ„ > è¯­è¨€

* **ç›®å½•ç»“æ„æ¸…æ™°** æ¯” TS æ›´é‡è¦
* **èŒè´£åˆ†å±‚ä¸¥æ ¼**ï¼Œé¿å…â€œä¸€ä¸ªæ–‡ä»¶å†™åˆ°æ­»â€

### 2ï¸âƒ£ ç”¨ã€Œçº¦å®šã€å¼¥è¡¥ç±»å‹ç¼ºå¤±

* JSDoc
* ç»Ÿä¸€è¿”å›ç»“æ„
* ç»Ÿä¸€æ ¡éªŒå±‚
* ç¦æ­¢éšå¼è¡Œä¸º

---

## äºŒã€æ¨èé¡¹ç›®ç»“æ„ï¼ˆJS ç‰ˆï¼‰

```
app/
â”œâ”€â”€ web/                     # Next.js
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ page.js
â”‚   â”‚   â””â”€â”€ api/
â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ services/            # BFF å±‚
â”‚   â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ constants/
â”‚   â””â”€â”€ middleware.js
â”‚
â”œâ”€â”€ api/                  # Express
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app.js
â”‚   â”‚   â”œâ”€â”€ server.js
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ middlewares/
â”‚   â”‚   â”œâ”€â”€ validators/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â””â”€â”€ tests/
â”‚
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ constants.js
â”‚   â””â”€â”€ enums.js
â”‚
â”œâ”€â”€ .eslintrc.cjs
â”œâ”€â”€ .prettierrc
â””â”€â”€ package.json
```

---

## ä¸‰ã€å‘½åè§„èŒƒï¼ˆJS é¡¹ç›®æ›´è¦ä¸¥æ ¼ï¼‰

### 3ï¸âƒ£ æ–‡ä»¶ / ç›®å½•

| ç±»å‹         | è§„èŒƒ                  | ç¤ºä¾‹                   |
| ---------- | ------------------- | -------------------- |
| ç›®å½•         | kebab-case          | `user-profile/`      |
| React ç»„ä»¶   | PascalCase          | `UserCard.jsx`       |
| hooks      | useXxx              | `useAuth.js`         |
| service    | camelCase           | `user.service.js`    |
| route      | resource.routes     | `user.routes.js`     |
| controller | resource.controller | `user.controller.js` |

---

## å››ã€Next.js ç¼–å†™è§„èŒƒï¼ˆJSï¼‰

### 4ï¸âƒ£ é¡µé¢å±‚ï¼ˆapp/ï¼‰

```js
// app/user/page.js
import { getUsers } from '@/services/user.service'

export default async function UserPage() {
  const users = await getUsers()
  return <UserList users={users} />
}
```

**è§„èŒƒ**

* é¡µé¢åªåšæ•°æ®ç»„ç»‡ + ç»„ä»¶æ‹¼è£…
* âŒ ä¸å†™ fetch URL
* âŒ ä¸å†™ä¸šåŠ¡é€»è¾‘

---

### 5ï¸âƒ£ BFFï¼ˆæœåŠ¡è°ƒç”¨å±‚ï¼‰

```js
// services/user.service.js
import { apiClient } from '@/utils/apiClient'

export async function getUsers() {
  return apiClient.get('/users')
}
```

**è§„èŒƒ**

* æ‰€æœ‰æ¥å£è¯·æ±‚å¿…é¡»é€šè¿‡ service
* é›†ä¸­å¤„ç†é”™è¯¯

---

### 6ï¸âƒ£ Client / Server Component è§„åˆ™

```js
'use client'
```

**è§„èŒƒ**

* é»˜è®¤ Server Component
* åªæœ‰ç”¨åˆ°ï¼š

  * useState / useEffect
  * DOM / window
  * äº‹ä»¶
    æ‰åŠ  `'use client'`

---

## äº”ã€Express ç¼–å†™è§„èŒƒï¼ˆJSï¼‰

### 7ï¸âƒ£ Routesï¼ˆåªåšæ˜ å°„ï¼‰

```js
// routes/user.routes.js
router.get('/', userController.list)
router.post('/', validate(createUserSchema), userController.create)
```

âŒ è·¯ç”±é‡Œå†™é€»è¾‘
âŒ è·¯ç”±é‡Œè®¿é—® DB

---

### 8ï¸âƒ£ Controllerï¼ˆè¯·æ±‚/å“åº”ï¼‰

```js
// controllers/user.controller.js
export async function list(req, res, next) {
  try {
    const users = await userService.getUsers()
    res.success(users)
  } catch (e) {
    next(e)
  }
}
```

**è§„èŒƒ**

* åªå¤„ç†å‚æ•°
* ç»Ÿä¸€ try/catch â†’ next

---

### 9ï¸âƒ£ Serviceï¼ˆä¸šåŠ¡æ ¸å¿ƒï¼‰

```js
// services/user.service.js
export async function getUsers() {
  return userModel.findAll()
}
```

**è§„èŒƒ**

* æ‰€æœ‰ä¸šåŠ¡é€»è¾‘åœ¨è¿™é‡Œ
* å¯å¤ç”¨ / å¯æµ‹è¯•

---

## å…­ã€å‚æ•°æ ¡éªŒï¼ˆJS é¡¹ç›®å¿…å¤‡ï¼‰

```js
// validators/user.schema.js
import Joi from 'joi'

export const createUserSchema = Joi.object({
  name: Joi.string().required(),
  age: Joi.number().min(0)
})
```

```js
router.post('/', validate(createUserSchema), controller.create)
```

> **JS æ²¡ç±»å‹ï¼Œæ ¡éªŒå±‚ = ç”Ÿå‘½çº¿**

---

## ä¸ƒã€ç»Ÿä¸€è¿”å› & é”™è¯¯è§„èŒƒ

### ğŸ”Ÿ è¿”å›ç»“æ„

```json
{
  "code": 0,
  "message": "ok",
  "data": {}
}
```

```js
res.success = (data) => {
  res.json({ code: 0, message: 'ok', data })
}
```

---

### 1ï¸âƒ£1ï¸âƒ£ é”™è¯¯å¤„ç†

```js
app.use((err, req, res, next) => {
  console.error(err)
  res.status(500).json({
    code: 500,
    message: err.message || 'Server Error'
  })
})
```

---

## å…«ã€JSDocï¼ˆå¼ºçƒˆæ¨èï¼‰

```js
/**
 * è·å–ç”¨æˆ·åˆ—è¡¨
 * @param {Object} options
 * @returns {Promise<Array<User>>}
 */
export async function getUsers(options) {}
```

**è§„èŒƒ**

* service / utils å¿…é¡»å†™
* controller å¯é€‰

---

## ä¹ã€ESLintï¼ˆJS é¡¹ç›®ä¸€å®šè¦ä¸Šï¼‰

### æ¨èå…³é”®è§„åˆ™

```js
rules: {
  'no-unused-vars': 'error',
  'no-implicit-globals': 'error',
  'eqeqeq': 'error',
  'no-console': ['warn', { allow: ['warn', 'error'] }]
}
```

---

## åã€ç¯å¢ƒå˜é‡è§„èŒƒ

```env
# Next
NEXT_PUBLIC_API_BASE_URL=

# Express
DB_URL=
JWT_SECRET=
```

**è§„åˆ™**

* ä¸è·¨ç«¯
* ä¸ç›´æ¥å†™æ­»åœ¨ä»£ç 

---

## åä¸€ã€JS é¡¹ç›®å¸¸è§é›·åŒº

âŒ controller ç›´æ¥æ“ä½œæ•°æ®åº“
âŒ React ç»„ä»¶é‡Œå†™å¤æ‚ä¸šåŠ¡
âŒ ä»»æ„ return ä¸ç»Ÿä¸€ç»“æ„
âŒ ä¸æ ¡éªŒå‚æ•°
âŒ utils å˜â€œåƒåœ¾æ¡¶æ–‡ä»¶â€

---

## åäºŒã€ç»™ä½ çš„ç°å®å»ºè®®ï¼ˆéå¸¸é‡è¦ï¼‰

> **JS + Next + Express**
> æƒ³é•¿æœŸç»´æŠ¤ï¼Œå¿…é¡»è‡³å°‘åšåˆ°ä¸‰ä»¶äº‹ï¼š

1. **JSDoc + æ ¡éªŒå±‚**
2. **Service / Controller / Route ä¸¥æ ¼åˆ†å±‚**
3. **ç»Ÿä¸€é”™è¯¯ & è¿”å›æ ¼å¼**

ä½ è¿™ä¸ªæŠ€æœ¯æ ˆ **å®Œå…¨é€‚åˆ BFF + åç«¯è§£è€¦**ï¼Œä»¥åå³ä½¿ä½ è¦è¿ TSï¼Œä¹Ÿæ˜¯**å¹³æ»‘å‡çº§**ã€‚

---

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥ï¼š

* ğŸ”¹ ç»™ä½ ä¸€å¥— **JS ç‰ˆå¯ç›´æ¥ç”¨çš„æ¨¡æ¿**
* ğŸ”¹ å¸®ä½ æŠŠä½ ç°åœ¨çš„ç›®å½•ã€Œå¯¹ç…§é‡æ„ä¸€ç‰ˆè§„èŒƒã€
* ğŸ”¹ ç»™ä½ ä¸€ä»½ **ESLint é…ç½® + æäº¤è§„èŒƒ**

ä½ æ›´æƒ³è¦å“ªä¸€ä¸ªï¼Ÿ
